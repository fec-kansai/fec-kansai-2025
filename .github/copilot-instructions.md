# GitHub Copilot カスタムインストラクション

このドキュメントは、GitHub Copilot がローカルや GitHub 上でのレビュー、コード生成などを行う際に参照するためのカスタムインストラクションです。

## 基本ルール

1. **応答言語**: 質問への回答は常に日本語で行ってください。
2. **確認メッセージ**: ルールを参照したことを示すため、回答の冒頭に「ルールを参照しました！」と表示してください。

## ディレクトリ構造の理解

### apps/storybook

- Storybook 用のディレクトリ
- `apps/web/components` の汎用コンポーネントと `packages/ui/components` の shadcn/ui コンポーネントを登録
- VRT による差分検知のためのページも登録
- 自作した汎用コンポーネントは原則として全て登録
- shadcn/ui コンポーネントは原則として全て登録（加工無しのものは最低限の設定で OK）

### apps/web

- 実際のウェブサイトのアプリケーション

#### app

- Next.js の app router の app ディレクトリ
- 基本的には `page.tsx` のみ配置
- ページ固有のコンポーネントや hooks は `page` ディレクトリに配置

#### components

- 汎用コンポーネントを配置
- shadcn/ui のコンポーネントは `packages/ui` に配置
- 汎用コンポーネントは原則として shadcn/ui から採用し、対応できないもののみ自作

#### page

- ページ固有のコンポーネントや hooks を配置
- コンポーネント: `page/{page}/components/{component}.tsx`
- hooks: `page/{page}/hooks/{hook}.ts`
- `page/{page}/index.tsx` で各コンポーネントや hooks を組み合わせ、app ディレクトリの `page.tsx` で利用

#### hooks

- 汎用的な React のカスタムフックを配置

#### lib

- 汎用的な関数などを配置

### packages/ui

- shadcn/ui のコンポーネントを配置
- 内部のディレクトリ構造は apps/web とほぼ同じ

## 開発フロー

以下は機能開発からデプロイまでの一連のフローです：

1. 該当 Issue のステータスを「In Progress」に変更
2. staging ブランチから新しいブランチを作成（変更内容が分かる命名にする）
3. 開発作業を実施
4. 動作確認・セルフレビューの実施
5. Pull Request の作成
    - タイトル: 変更内容を簡潔に表現（プレフィックス不要）
    - 説明文: プロジェクトのテンプレートに従う
    - Commit Message: README のルールに従う
    - Assignees に自分を設定（Reviewers は任意）
6. Issue のステータスを「In Review」に変更
7. Discord でレビュー依頼
8. レビューを受ける
9. 1 つ以上の Approve を得たらマージ
10. Issue のステータスを「Done」に変更
11. staging ブランチへのマージ後、自動的にステージング環境へデプロイ
12. ステージング環境での動作確認後、main ブランチへのマージ PR を作成・マージ（Approve は原則不要）
13. main へのマージ後、自動的に本番環境へデプロイ
14. 本番環境での最終確認

## レビュールール

- チーム内の空き状況に応じて誰でもレビュー可能
- チーム外の人もレビュー可能だが、マージ条件の Approve 数にはチーム内メンバーのみカウント
- コメントには温度感を示すために以下のような表現を推奨:
  - `must`: 修正必須
  - `imo`: 個人的な意見
  - `nits`: 細かい指摘

## コード生成のベストプラクティス

1. ディレクトリ構造の理解に基づいたファイル配置
2. shadcn/ui コンポーネントを優先的に活用し、不足分のみ自作
3. コンポーネントごとに Storybook 登録を考慮
4. Next.js の app router の設計方針に従ったコード構成
5. 各ディレクトリの役割に応じたコードの配置

## サポートメッセージ

コードレビュー、リファクタリング、新機能の実装、バグ修正など、プロジェクトに関するあらゆる質問や依頼に対応します。プロジェクト構造とチーム開発ルールに基づいたサポートを提供します。
